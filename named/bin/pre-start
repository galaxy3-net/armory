#!/usr/bin/env bash
var1=${@}

__RESOLVE_FILE__=/etc/resolv.conf

function remove_google
{
  sed -d 'd/nameserver 8.8.8.8/' /etc/resolv.conf
}

function update_domain
{
  echo "domain ${1}" >> ${__RESOLVE_FILE__}
}

function update_searchlist
{
  echo "Adding search list"
  echo "search ${@}" >> ${__RESOLVE_FILE__}
}

function start_docker
{
  sudo systemctl enable docker
  sudo systemctl restart docker
}

echo ${__INTERFACE__}
sudo ifconfig ${__INTERFACE__}:0 10.55.55.2 netmask 255.255.255.0 up

remove_google

cat <<__EOD__

  Processing Domains

  ${var1[@]}

__EOD__


for item in ${var1[@]}
do
  echo "Checking ${item}"
  egrep "domain ${item}" ${__RESOLVE_FILE__} ||  update_domain "${item}"
done

egrep "search ${var1[@]}" ${__RESOLVE_FILE__} || update_searchlist ${var1[@]}

printf "\n\n${__RESOLVE_FILE__}\n"
cat ${__RESOLVE_FILE__}

cat <<__EOD__

Finished

__EOD__


../bin/docker-status ; [ ${?} -ne 0 ] && start_docker
